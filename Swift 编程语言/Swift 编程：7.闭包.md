é—­åŒ…æ˜¯è‡ªåŒ…å«çš„å‡½æ•°ä»£ç å—ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­è¢«ä¼ é€’å’Œä½¿ç”¨ã€‚Swift ä¸­çš„é—­åŒ…ä¸ C å’Œ Objective-C ä¸­çš„ä»£ç å—ï¼ˆblocksï¼‰ä»¥åŠå…¶ä»–ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­çš„åŒ¿åå‡½æ•°ï¼ˆLambdasï¼‰æ¯”è¾ƒç›¸ä¼¼ã€‚

é—­åŒ…å¯ä»¥æ•è·å’Œå­˜å‚¨å…¶æ‰€åœ¨ä¸Šä¸‹æ–‡ä¸­ä»»æ„å¸¸é‡å’Œå˜é‡çš„å¼•ç”¨ã€‚è¢«ç§°ä¸ºåŒ…è£¹å¸¸é‡å’Œå˜é‡ã€‚ Swift ä¼šä¸ºä½ ç®¡ç†åœ¨æ•è·è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ‰€æœ‰å†…å­˜æ“ä½œã€‚

é—­åŒ…é‡‡ç”¨å¦‚ä¸‹ä¸‰ç§å½¢å¼ä¹‹ä¸€ï¼š

* å…¨å±€å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—ä½†ä¸ä¼šæ•è·ä»»ä½•å€¼çš„é—­åŒ…
* åµŒå¥—å‡½æ•°æ˜¯ä¸€ä¸ªæœ‰åå­—å¹¶å¯ä»¥æ•è·å…¶å°é—­å‡½æ•°åŸŸå†…å€¼çš„é—­åŒ…
* é—­åŒ…è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªåˆ©ç”¨è½»é‡çº§è¯­æ³•æ‰€å†™çš„å¯ä»¥æ•è·å…¶ä¸Šä¸‹æ–‡ä¸­å˜é‡æˆ–å¸¸é‡å€¼çš„åŒ¿åé—­åŒ…

Swift çš„é—­åŒ…è¡¨è¾¾å¼æ‹¥æœ‰ç®€æ´çš„é£æ ¼ï¼Œå¹¶é¼“åŠ±åœ¨å¸¸è§åœºæ™¯ä¸­è¿›è¡Œè¯­æ³•ä¼˜åŒ–ï¼Œä¸»è¦ä¼˜åŒ–å¦‚ä¸‹ï¼š

* åˆ©ç”¨ä¸Šä¸‹æ–‡æ¨æ–­å‚æ•°å’Œè¿”å›å€¼ç±»å‹
* éšå¼è¿”å›å•è¡¨è¾¾å¼é—­åŒ…ï¼Œå³å•è¡¨è¾¾å¼é—­åŒ…å¯ä»¥çœç•¥ return å…³é”®å­—
* å‚æ•°åç§°ç¼©å†™
* å°¾éšé—­åŒ…è¯­æ³•

## é—­åŒ…è¡¨è¾¾å¼

### æ’åºæ–¹æ³•

Swift æ ‡å‡†åº“æä¾›äº†åä¸º `sorted(by:)` çš„æ–¹æ³•ï¼Œå®ƒä¼šåŸºäºä½ æä¾›çš„æ’åºé—­åŒ…è¡¨è¾¾å¼çš„åˆ¤æ–­ç»“æœå¯¹æ•°ç»„ä¸­çš„å€¼ï¼ˆç±»å‹ç¡®å®šï¼‰è¿›è¡Œæ’åºã€‚ä¸€æ—¦å®ƒå®Œæˆæ’åºè¿‡ç¨‹ï¼Œ`sorted(by:)` æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸æ—§æ•°ç»„ç±»å‹å¤§å°ç›¸åŒç±»å‹çš„æ–°æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„å…ƒç´ æœ‰ç€æ­£ç¡®çš„æ’åºé¡ºåºã€‚åŸæ•°ç»„ä¸ä¼šè¢« `sorted(by:)` æ–¹æ³•ä¿®æ”¹ã€‚

```swift
let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]

// V1ï¼šæ™®é€šç‰ˆæœ¬
func backward(_ s1: String, _ s2: String) -> Bool {
    return s1 > s2
}
var reversedNames = names.sorted(by: backward)
// reversedNames ä¸º ["Ewa", "Daniella", "Chris", "Barry", "Alex"]
```


### é—­åŒ…è¡¨è¾¾å¼è¯­æ³•

> ğŸ’¡ æœ‰å‡½æ•°å‚æ•°ç±»å‹çš„åŒ¿åå‡½æ•°ï¼Ÿ

```swift
{ (parameters) -> return type in
    statements
}
```

é—­åŒ…è¡¨è¾¾å¼ç‰ˆæœ¬çš„ä»£ç ï¼š

```swift
let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]

// V2ï¼šé—­åŒ…è¡¨è¾¾å¼ç‰ˆæœ¬
// æ’åºé—­åŒ…çš„å‡½æ•°ç±»å‹ï¼š(String, String) -> Bool
reversedNames = names.sorted(by: { (s1: String, s2: String) -> Bool in
    return s1 > s2
})
```

é—­åŒ…çš„å‡½æ•°ä½“éƒ¨åˆ†ç”±å…³é”®å­— `in` å¼•å…¥ã€‚è¯¥å…³é”®å­—è¡¨ç¤ºé—­åŒ…çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹å®šä¹‰å·²ç»å®Œæˆï¼Œé—­åŒ…å‡½æ•°ä½“å³å°†å¼€å§‹ã€‚

### æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹

å› ä¸ºæ’åºé—­åŒ…å‡½æ•°æ˜¯ä½œä¸º `sorted(by:)` æ–¹æ³•çš„å‚æ•°ä¼ å…¥çš„ï¼ŒSwift å¯ä»¥æ¨æ–­å…¶å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ã€‚`sorted(by:)` æ–¹æ³•è¢«ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„è°ƒç”¨ï¼Œå› æ­¤å…¶å‚æ•°å¿…é¡»æ˜¯ `(String, String) -> Bool` ç±»å‹çš„å‡½æ•°ã€‚è¿™æ„å‘³ç€ `(String, String)` å’Œ `Bool` ç±»å‹å¹¶ä¸éœ€è¦ä½œä¸ºé—­åŒ…è¡¨è¾¾å¼å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚å› ä¸ºæ‰€æœ‰çš„ç±»å‹éƒ½å¯ä»¥è¢«æ­£ç¡®æ¨æ–­ï¼Œè¿”å›ç®­å¤´ï¼ˆ`->`ï¼‰å’Œå›´ç»•åœ¨å‚æ•°å‘¨å›´çš„æ‹¬å·ä¹Ÿå¯ä»¥è¢«çœç•¥

```swift
// åœ¨å†…è”é—­åŒ…è¡¨è¾¾å¼ä¸­ï¼ŒSwift å¯ä»¥æ¨æ–­å…¶å‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼Œå¯ä»¥çœç•¥
reversedNames = names.sorted(by: { s1, s2 in
    return s1 > s2
})
```

### å•è¡¨è¾¾å¼é—­åŒ…çš„éšå¼è¿”å›


å•è¡Œè¡¨è¾¾å¼é—­åŒ…å¯ä»¥é€šè¿‡çœç•¥ `return` å…³é”®å­—æ¥éšå¼è¿”å›å•è¡Œè¡¨è¾¾å¼çš„ç»“æœï¼š

```swift
reversedNames = names.sorted(by: { s1, s2 in s1 > s2 } )
```

### å‚æ•°åç§°ç¼©å†™

Swift è‡ªåŠ¨ä¸ºå†…è”é—­åŒ…æä¾›äº†å‚æ•°åç§°ç¼©å†™åŠŸèƒ½ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ `$0`ï¼Œ`$1`ï¼Œ`$2` æ¥é¡ºåºè°ƒç”¨é—­åŒ…çš„å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚

å¦‚æœä½ åœ¨é—­åŒ…è¡¨è¾¾å¼ä¸­ä½¿ç”¨å‚æ•°åç§°ç¼©å†™ï¼Œä½ å¯ä»¥åœ¨é—­åŒ…å®šä¹‰ä¸­çœç•¥å‚æ•°åˆ—è¡¨ï¼Œå¹¶ä¸”å¯¹åº”å‚æ•°åç§°ç¼©å†™çš„ç±»å‹ä¼šé€šè¿‡å‡½æ•°ç±»å‹è¿›è¡Œæ¨æ–­ã€‚`in` å…³é”®å­—ä¹ŸåŒæ ·å¯ä»¥è¢«çœç•¥ï¼Œå› ä¸ºæ­¤æ—¶é—­åŒ…è¡¨è¾¾å¼å®Œå…¨ç”±é—­åŒ…å‡½æ•°ä½“æ„æˆï¼š

```swift
// é€šè¿‡ $0, $1 ,$2 æ¥é¡ºåºè°ƒç”¨é—­åŒ…çš„å‚æ•°
reversedNames = names.sorted(by: { $0 > $1 } )
```

### è¿ç®—ç¬¦æ–¹æ³•

å®é™…ä¸Šè¿˜æœ‰ä¸€ç§æ›´ç®€çŸ­çš„æ–¹å¼æ¥ç¼–å†™ä¸Šé¢ä¾‹å­ä¸­çš„é—­åŒ…è¡¨è¾¾å¼ã€‚Swift çš„ `String` ç±»å‹å®šä¹‰äº†å…³äºå¤§äºå·ï¼ˆ>ï¼‰çš„å­—ç¬¦ä¸²å®ç°ï¼Œå…¶ä½œä¸ºä¸€ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª `String` ç±»å‹çš„å‚æ•°å¹¶è¿”å› `Bool` ç±»å‹çš„å€¼ã€‚è€Œè¿™æ­£å¥½ä¸ `sorted(by:)` æ–¹æ³•çš„å‚æ•°éœ€è¦çš„å‡½æ•°ç±»å‹ç›¸ç¬¦åˆã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç®€å•åœ°ä¼ é€’ä¸€ä¸ªå¤§äºå·ï¼ŒSwift å¯ä»¥è‡ªåŠ¨æ¨æ–­æ‰¾åˆ°ç³»ç»Ÿè‡ªå¸¦çš„é‚£ä¸ªå­—ç¬¦ä¸²å‡½æ•°çš„å®ç°ï¼š

```swift
// Swift çš„ String ç±»å‹å®šä¹‰äº†å…³äºå¤§äºå·çš„å­—ç¬¦ä¸²å®ç°
reversedNames = names.sorted(by: >)
```


## å°¾éšé—­åŒ…

å¦‚æœä½ éœ€è¦å°†ä¸€ä¸ªå¾ˆé•¿çš„é—­åŒ…è¡¨è¾¾å¼ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå°†è¿™ä¸ªé—­åŒ…æ›¿æ¢æˆä¸ºå°¾éšé—­åŒ…çš„å½¢å¼å¾ˆæœ‰ç”¨ã€‚

å°¾éšé—­åŒ…æ˜¯ä¸€ä¸ªä¹¦å†™åœ¨å‡½æ•°åœ†æ‹¬å·ä¹‹åçš„é—­åŒ…è¡¨è¾¾å¼ï¼Œå‡½æ•°æ”¯æŒå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°è°ƒç”¨ã€‚åœ¨ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ä¸ç”¨å†™å‡ºå®ƒçš„å‚æ•°æ ‡ç­¾

```swift
func someFunctionThatTakesAClosure(closure: () -> Void) {
    // å‡½æ•°ä½“éƒ¨åˆ†
}

// ä»¥ä¸‹æ˜¯ä¸ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
someFunctionThatTakesAClosure(closure: {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
})

// ä»¥ä¸‹æ˜¯ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
someFunctionThatTakesAClosure() {
    // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
}
```


åœ¨ é—­åŒ…è¡¨è¾¾å¼è¯­æ³• ä¸Šç« èŠ‚ä¸­çš„å­—ç¬¦ä¸²æ’åºé—­åŒ…å¯ä»¥ä½œä¸ºå°¾éšåŒ…çš„å½¢å¼æ”¹å†™åœ¨ `sorted(by:)` æ–¹æ³•åœ†æ‹¬å·çš„å¤–é¢ï¼š

```swift
reversedNames = names.sorted() { $0 > $1 }
```

å¦‚æœ**é—­åŒ…è¡¨è¾¾å¼æ˜¯å‡½æ•°æˆ–æ–¹æ³•çš„å”¯ä¸€å‚æ•°**ï¼Œåˆ™å½“ä½ ä½¿ç”¨å°¾éšé—­åŒ…æ—¶ï¼Œä½ ç”šè‡³å¯ä»¥æŠŠ `()` çœç•¥æ‰ï¼š

```swift
reversedNames = names.sorted { $0 > $1 }
```

å½“é—­åŒ…éå¸¸é•¿ä»¥è‡³äºä¸èƒ½åœ¨ä¸€è¡Œä¸­è¿›è¡Œä¹¦å†™æ—¶ï¼Œå°¾éšé—­åŒ…å˜å¾—éå¸¸æœ‰ç”¨ã€‚

```swift
let strings = numbers.map {
    // è¯¥é—­åŒ…çš„å‡½æ•°ç±»å‹ï¼š(number) -> String
    (number) -> String in
    var number = number
    var output = ""
    repeat {
        output = digitNames[number % 10]! + output
        number /= 10
    } while number > 0
    return output
}
// strings å¸¸é‡è¢«æ¨æ–­ä¸ºå­—ç¬¦ä¸²ç±»å‹æ•°ç»„ï¼Œå³ [String]
// å…¶å€¼ä¸º ["OneSix", "FiveEight", "FiveOneZero"]
```


### å€¼æ•è·

é—­åŒ…å¯ä»¥åœ¨å…¶è¢«å®šä¹‰çš„ä¸Šä¸‹æ–‡ä¸­æ•è·å¸¸é‡æˆ–å˜é‡ã€‚å³ä½¿å®šä¹‰è¿™äº›å¸¸é‡å’Œå˜é‡çš„åŸä½œç”¨åŸŸå·²ç»ä¸å­˜åœ¨ï¼Œé—­åŒ…ä»ç„¶å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¼•ç”¨å’Œä¿®æ”¹è¿™äº›å€¼ã€‚

```swift
func makeIncrementer(forIncrement amount: Int) -> () -> Int {
    var runningTotal = 0
    func incrementer() -> Int {
        // incrementer å‡½æ•°å¹¶æ²¡æœ‰ä»»ä½•å‚æ•°
        // ä½†æ˜¯åœ¨å‡½æ•°ä½“å†…å¯ä»¥è®¿é—® runningTotal å’Œ amount å˜é‡
        runningTotal += amount
        return runningTotal
    }
    return incrementer
}
```

> âš ï¸
> 
> ä¸ºäº†ä¼˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸ä¼šè¢«é—­åŒ…æ”¹å˜ï¼Œæˆ–è€…åœ¨é—­åŒ…åˆ›å»ºåä¸ä¼šæ”¹å˜ï¼ŒSwift å¯èƒ½ä¼šæ”¹ä¸ºæ•è·å¹¶ä¿å­˜ä¸€ä»½å¯¹å€¼çš„æ‹·è´ã€‚
> Swift ä¹Ÿä¼šè´Ÿè´£è¢«æ•è·å˜é‡çš„æ‰€æœ‰å†…å­˜ç®¡ç†å·¥ä½œï¼ŒåŒ…æ‹¬é‡Šæ”¾ä¸å†éœ€è¦çš„å˜é‡ã€‚


### é—­åŒ…æ˜¯å¼•ç”¨ç±»å‹

æ— è®ºä½ å°†å‡½æ•°æˆ–é—­åŒ…èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡è¿˜æ˜¯å˜é‡ï¼Œä½ å®é™…ä¸Šéƒ½æ˜¯å°†å¸¸é‡æˆ–å˜é‡çš„å€¼è®¾ç½®ä¸ºå¯¹åº”å‡½æ•°æˆ–é—­åŒ…çš„å¼•ç”¨ã€‚

è¿™ä¹Ÿæ„å‘³ç€å¦‚æœä½ å°†é—­åŒ…èµ‹å€¼ç»™äº†ä¸¤ä¸ªä¸åŒçš„å¸¸é‡æˆ–å˜é‡ï¼Œä¸¤ä¸ªå€¼éƒ½ä¼šæŒ‡å‘åŒä¸€ä¸ªé—­åŒ…ï¼š

```swift
let alsoIncrementByTen = incrementByTen
alsoIncrementByTen()
// è¿”å›çš„å€¼ä¸º50
```

### é€ƒé€¸é—­åŒ…*

å½“ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰è¢«æ‰§è¡Œï¼Œæˆ‘ä»¬ç§°è¯¥é—­åŒ…ä»å‡½æ•°ä¸­*é€ƒé€¸*ã€‚å½“ä½ å®šä¹‰æ¥å—é—­åŒ…ä½œä¸ºå‚æ•°çš„å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥åœ¨å‚æ•°åä¹‹å‰æ ‡æ³¨ `@escaping`ï¼Œç”¨æ¥æŒ‡æ˜è¿™ä¸ªé—­åŒ…æ˜¯å…è®¸â€œé€ƒé€¸â€å‡ºè¿™ä¸ªå‡½æ•°çš„ã€‚

```swift
// ä¸€ç§èƒ½ä½¿é—­åŒ…â€œé€ƒé€¸â€å‡ºå‡½æ•°çš„æ–¹æ³•æ˜¯ï¼Œå°†è¿™ä¸ªé—­åŒ…ä¿å­˜åœ¨ä¸€ä¸ªå‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ä¸­ã€‚
var completionHandlers: [() -> Void] = []
func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
    completionHandlers.append(completionHandler)
}
```

å°†ä¸€ä¸ªé—­åŒ…æ ‡è®°ä¸º `@escaping` æ„å‘³ç€ä½ å¿…é¡»åœ¨é—­åŒ…ä¸­æ˜¾å¼åœ°å¼•ç”¨ `self`ã€‚


### è‡ªåŠ¨é—­åŒ…*

*è‡ªåŠ¨é—­åŒ…*æ˜¯ä¸€ç§è‡ªåŠ¨åˆ›å»ºçš„é—­åŒ…ï¼Œç”¨äºåŒ…è£…ä¼ é€’ç»™å‡½æ•°ä½œä¸ºå‚æ•°çš„è¡¨è¾¾å¼ã€‚è¿™ç§é—­åŒ…ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œå½“å®ƒè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šè¿”å›è¢«åŒ…è£…åœ¨å…¶ä¸­çš„è¡¨è¾¾å¼çš„å€¼ã€‚è¿™ç§ä¾¿åˆ©è¯­æ³•è®©ä½ èƒ½å¤Ÿçœç•¥é—­åŒ…çš„èŠ±æ‹¬å·ï¼Œç”¨ä¸€ä¸ªæ™®é€šçš„è¡¨è¾¾å¼æ¥ä»£æ›¿æ˜¾å¼çš„é—­åŒ…ã€‚

æˆ‘ä»¬ç»å¸¸ä¼šè°ƒç”¨é‡‡ç”¨è‡ªåŠ¨é—­åŒ…çš„å‡½æ•°ï¼Œä½†æ˜¯å¾ˆå°‘å»å®ç°è¿™æ ·çš„å‡½æ•°ã€‚

è‡ªåŠ¨é—­åŒ…è®©ä½ èƒ½å¤Ÿå»¶è¿Ÿæ±‚å€¼ï¼Œå› ä¸ºç›´åˆ°ä½ è°ƒç”¨è¿™ä¸ªé—­åŒ…ï¼Œä»£ç æ®µæ‰ä¼šè¢«æ‰§è¡Œã€‚å»¶è¿Ÿæ±‚å€¼å¯¹äºé‚£äº›æœ‰å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰å’Œé«˜è®¡ç®—æˆæœ¬çš„ä»£ç æ¥è¯´æ˜¯å¾ˆæœ‰ç›Šå¤„çš„ï¼Œå› ä¸ºå®ƒä½¿å¾—ä½ èƒ½æ§åˆ¶ä»£ç çš„æ‰§è¡Œæ—¶æœºã€‚

```swift
var customersInLine = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]
print(customersInLine.count)
// æ‰“å°å‡ºâ€œ5â€

// å®šä¹‰äº†ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…ï¼Œä½†ç°åœ¨å®ƒè¿˜æ²¡æœ‰è¢«è°ƒç”¨
// customerProvider çš„å‡½æ•°ç±»å‹ï¼š() -> String
let customerProvider = { customersInLine.remove(at: 0) }
print(customersInLine.count)
// æ‰“å°å‡ºâ€œ5â€

print("Now serving \(customerProvider())!")
// Prints "Now serving Chris!"
print(customersInLine.count)
// æ‰“å°å‡ºâ€œ4â€
```

é€šè¿‡å°†å‚æ•°æ ‡è®°ä¸º `@autoclosure` æ¥æ¥æ”¶ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…ã€‚

å¦‚æœä½ æƒ³è®©ä¸€ä¸ªè‡ªåŠ¨é—­åŒ…å¯ä»¥â€œé€ƒé€¸â€ï¼Œåˆ™åº”è¯¥åŒæ—¶ä½¿ç”¨ `@autoclosure` å’Œ `@escaping` å±æ€§ã€‚




