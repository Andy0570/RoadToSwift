> åŸæ–‡ï¼š[Customizing Codable types in Swift @John Sundell](https://www.swiftbysundell.com/articles/customizing-codable-types-in-swift/)



å¤§å¤šæ•°ç°ä»£åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå…±åŒç‰¹ç‚¹æ˜¯ï¼Œå®ƒä»¬éœ€è¦å¯¹å„ç§å½¢å¼çš„æ•°æ®è¿›è¡Œç¼–ç æˆ–è§£ç ã€‚æ— è®ºæ˜¯é€šè¿‡ç½‘ç»œä¸‹è½½çš„ JSON æ•°æ®ï¼Œè¿˜æ˜¯æœ¬åœ°å­˜å‚¨çš„æ¨¡å‹çš„æŸç§å½¢å¼çš„åºåˆ—åŒ–æ•°æ®ï¼Œèƒ½å¤Ÿå¯é åœ°ç¼–ç å’Œè§£ç ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œå¯¹ä»»ä½• Swift ä»£ç åº“æ¥è¯´éƒ½æ˜¯è‡³å…³é‡è¦çš„ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Swift çš„ `Codable` API åœ¨ä½œä¸º Swift 4.0 çš„ä¸€éƒ¨åˆ†è¢«å¼•å…¥æ—¶æ˜¯ä¸€ä¸ªå¦‚æ­¤é‡è¦çš„æ–°åŠŸèƒ½â€”â€”ä»é‚£æ—¶èµ·ï¼Œå®ƒå·²ç»å‘å±•æˆä¸ºä¸€ä¸ªæ ‡å‡†çš„ã€å¼ºå¤§çš„æœºåˆ¶ï¼Œç”¨äºå‡ ç§ä¸åŒç±»å‹çš„ç¼–ç å’Œè§£ç â€”â€”æ— è®ºæ˜¯åœ¨è‹¹æœçš„å¹³å°ä¸Šï¼Œè¿˜æ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„ Swiftã€‚

`Codable` ä¹‹æ‰€ä»¥å¦‚æ­¤ä¼Ÿå¤§ï¼Œæ˜¯å› ä¸ºå®ƒä¸ Swift å·¥å…·é“¾ç´§å¯†ç»“åˆï¼Œä½¿å¾—ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨åˆæˆè®¸å¤šç¼–ç å’Œè§£ç å„ç§æ•°å€¼æ‰€éœ€çš„ä»£ç ã€‚ç„¶è€Œï¼Œæœ‰æ—¶æˆ‘ä»¬ç¡®å®éœ€è¦å®šåˆ¶æˆ‘ä»¬çš„å€¼åœ¨åºåˆ—åŒ–æ—¶çš„è¡¨ç¤ºæ–¹å¼â€”â€”æ‰€ä»¥æœ¬å‘¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æœ‰å“ªäº›ä¸åŒçš„æ–¹æ³•å¯ä»¥è°ƒæ•´æˆ‘ä»¬çš„ Codable å®ç°æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚



## æ”¹å˜ keys

è®©æˆ‘ä»¬ä»ä¸€ä¸ªåŸºæœ¬çš„æ–¹æ³•å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ä¸€ä¸ªç±»å‹çš„ç¼–ç å’Œè§£ç æ–¹å¼â€”â€”é€šè¿‡ä¿®æ”¹ä½œä¸ºå…¶åºåˆ—åŒ–è¡¨ç¤ºçš„ä¸€éƒ¨åˆ†çš„ keyã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªé˜…è¯»æ–‡ç« çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬çš„ä¸€ä¸ªæ ¸å¿ƒæ•°æ®æ¨¡å‹çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```swift
struct Article: Codable {
    var url: URL
    var title: String
    var body: String
}
```

æˆ‘ä»¬çš„æ¨¡å‹ç›®å‰ä½¿ç”¨äº†ä¸€ä¸ªå®Œå…¨è‡ªåŠ¨åˆæˆçš„ `Codable` å®ç°ï¼Œè¿™æ„å‘³ç€å®ƒæ‰€æœ‰çš„åºåˆ—åŒ– key éƒ½ä¸å®ƒçš„å±æ€§åç§°ç›¸åŒ¹é…ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å°†å¯¹æ–‡ç« å€¼è¿›è¡Œè§£ç çš„æ•°æ®â€”â€”ä¾‹å¦‚ä»æœåŠ¡å™¨ä¸Šä¸‹è½½çš„ JSONâ€”â€”å¯èƒ½ä¼šä½¿ç”¨ç¨å¾®ä¸åŒçš„å‘½åæƒ¯ä¾‹ï¼Œå¯¼è‡´é»˜è®¤è§£ç å¤±è´¥ã€‚

å¹¸å¥½ï¼Œè¿™å¾ˆå®¹æ˜“è§£å†³ã€‚æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯è‡ªå®šä¹‰ `Codable` åœ¨è§£ç ï¼ˆæˆ–ç¼–ç ï¼‰æˆ‘ä»¬çš„ `Article` ç±»å‹å®ä¾‹æ—¶ä½¿ç”¨çš„ keyï¼Œå°±æ˜¯åœ¨å…¶ä¸­å®šä¹‰ä¸€ä¸ª `CodingKeys` æšä¸¾â€”â€”å¹¶å°†è‡ªå®šä¹‰çš„åŸå§‹å€¼åˆ†é…ç»™ä¸æˆ‘ä»¬å¸Œæœ›è‡ªå®šä¹‰çš„ key åŒ¹é…çš„æƒ…å†µ--åƒè¿™æ ·ï¼š

```swift
extension Article {
    enum Codingkeys: String, CodingKey {
        case url = "soruce_link"
        case title = "content_name"
        case body
    }
}
```

ä¸Šè¿°åšæ³•è®©æˆ‘ä»¬åœ¨å®é™…çš„ç¼–ç å·¥ä½œä¸­ç»§ç»­åˆ©ç”¨ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤å®ç°ï¼ŒåŒæ—¶ä»ç„¶ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ”¹å˜å°†è¢«ç”¨äºåºåˆ—åŒ–çš„ key çš„åç§°ã€‚

è™½ç„¶ä¸Šè¿°æŠ€æœ¯å¯¹äºæˆ‘ä»¬æƒ³ä½¿ç”¨å®Œå…¨è‡ªå®šä¹‰çš„ key åç§°æ˜¯å¾ˆå¥½çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬åªæƒ³è®© `Codable` ä½¿ç”¨æˆ‘ä»¬å±æ€§åçš„ `snake_case` ç‰ˆæœ¬ï¼ˆä¾‹å¦‚å°† `backgroundColor` å˜æˆ `background_color`ï¼‰â€”â€”é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ”¹å˜æˆ‘ä»¬çš„ JSON è§£ç å™¨çš„ `keyDecodingStrategy`:

```swift
var decoder = JSONDecoder()
decoder.keyDecodingStrategy = .convertFromSnakeCase
```

ä¸Šè¿°ä¸¤ä¸ª API çš„ä¼Ÿå¤§ä¹‹å¤„åœ¨äºï¼Œå®ƒä»¬ä½¿æˆ‘ä»¬èƒ½å¤Ÿè§£å†³æˆ‘ä»¬çš„ Swift æ¨¡å‹å’Œç”¨æ¥è¡¨ç¤ºå®ƒä»¬çš„æ•°æ®ä¹‹é—´çš„ä¸åŒ¹é…é—®é¢˜ï¼Œè€Œä¸è¦æ±‚æˆ‘ä»¬ä¿®æ”¹æˆ‘ä»¬çš„å±æ€§åç§°ã€‚



## å¿½ç•¥ keys

è™½ç„¶èƒ½å¤Ÿè‡ªå®šä¹‰ç¼–ç  key çš„åç§°çœŸçš„å¾ˆæœ‰ç”¨ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬å¯èƒ½æƒ³å®Œå…¨å¿½ç•¥æŸäº› keyã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç¬”è®°åº”ç”¨ç¨‹åºâ€”â€”æˆ‘ä»¬è®©ç”¨æˆ·å°†å„ç§ç¬”è®°åˆ†ç»„ï¼Œå½¢æˆä¸€ä¸ª `NoteCollection`ï¼Œå…¶ä¸­å¯ä»¥åŒ…æ‹¬æœ¬åœ°è‰ç¨¿ï¼š

```swift
struct Note: Codable {
    var name: String
}

struct NoteCollection: Codable {
    var name: String
    var notes: [Note]
    var localDrafts = [Note]()
}
```

ç„¶è€Œï¼Œè™½ç„¶è®© `localDrafts` æˆä¸ºæˆ‘ä»¬ `NoteCollection` æ¨¡å‹çš„ä¸€éƒ¨åˆ†çœŸçš„å¾ˆæ–¹ä¾¿â€”â€”è®©æˆ‘ä»¬è¯´ï¼Œå½“åºåˆ—åŒ–æˆ–ååºåˆ—åŒ–è¿™æ ·ä¸€ä¸ªé›†åˆæ—¶ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›è¿™äº›è‰ç¨¿è¢«åŒ…æ‹¬åœ¨å†…ã€‚è¿™æ ·åšçš„åŸå› å¯èƒ½æ˜¯ä¸ºäº†è®©ç”¨æˆ·åœ¨æ¯æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶éƒ½æœ‰ä¸€ä¸ªå¹²å‡€çš„è®°å½•ï¼Œæˆ–è€…æ˜¯å› ä¸ºæˆ‘ä»¬çš„æœåŠ¡å™¨ä¸æ”¯æŒè‰ç¨¿äº‘ç«¯å¤‡ä»½åŠŸèƒ½ã€‚

å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°åšåˆ°ï¼Œè€Œä¸å¿…æ”¹å˜ `NoteCollection` çš„å®é™… `Codable` å®ç°ã€‚å¦‚æœæˆ‘ä»¬åƒä»¥å‰ä¸€æ ·å®šä¹‰ä¸€ä¸ª `CodingKeys `æšä¸¾ï¼Œå¹¶ç®€å•åœ°çœç•¥ `localDrafts` â€”â€”é‚£ä¹ˆåœ¨å¯¹ `NoteCollection` çš„å€¼è¿›è¡Œç¼–ç æˆ–è§£ç æ—¶ï¼Œè¯¥å±æ€§å°†ä¸ä¼šè¢«è€ƒè™‘åœ¨å†…ï¼š

```swift
extension NoteCollection {
    enum CodingKeys: CodingKey {
        case name
        case notes
    }
}
```

ä¸ºäº†ä½¿ä¸Šè¿°æ–¹æ³•å¥æ•ˆï¼Œæˆ‘ä»¬è¦çœç•¥çš„å±æ€§å¿…é¡»æœ‰ä¸€ä¸ªé»˜è®¤å€¼â€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`localDrafts` å·²ç»æœ‰äº†ã€‚



## åˆ›å»ºåŒ¹é…çš„ç»“æ„

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªè°ƒæ•´äº†ä¸€ä¸ªç±»å‹çš„ç¼–ç  keyâ€”â€”è™½ç„¶æˆ‘ä»¬ç»å¸¸å¯ä»¥é€šè¿‡è¿™æ ·åšæ¥è¾¾åˆ°ç›¸å½“å¤šçš„æ•ˆæœï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨ `Codable` å®šåˆ¶æ–¹é¢èµ°å¾—æ›´è¿œã€‚

æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬æ­£åœ¨å»ºç«‹ä¸€ä¸ªåŒ…æ‹¬è´§å¸è½¬æ¢åŠŸèƒ½çš„åº”ç”¨ç¨‹åºâ€”â€”æˆ‘ä»¬æ­£åœ¨ä¸‹è½½ç‰¹å®šè´§å¸çš„å½“å‰æ±‡ç‡ï¼Œä½œä¸º JSON æ•°æ®ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```swift
{
    "currency": "PLN",
    "rates": {
        "USD": 3.76,
        "EUR": 4.24,
        "SEK": 0.41
    }
}
```

åœ¨æˆ‘ä»¬çš„ Swift ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å°†è¿™äº› JSON å“åº”è½¬æ¢ä¸º `CurrencyConversion` å®ä¾‹â€”â€”æ¯ä¸ªå®ä¾‹åŒ…æ‹¬ä¸€ä¸ª`ExchangeRate` æ¡ç›®æ•°ç»„â€”â€”æ¯ç§è´§å¸ä¸€ä¸ªï¼š

```swift
struct ExchangeRate {
    let currency: Currency
    let rate: Double
}

struct CurrencyConversion {
    var currency: Currency
    var exchangeRates: [ExchangeRate]
}
```

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯ç»§ç»­å‰è¿›ï¼Œè®©ä¸Šè¿°ä¸¤ä¸ªæ¨¡å‹éƒ½éµå®ˆ Codable åè®®ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ Swift ä»£ç å’Œæˆ‘ä»¬æƒ³è¦è§£ç çš„ JSON æ•°æ®ä¹‹é—´åˆä¼šå‡ºç°ä¸åŒ¹é…ã€‚ä½†æ˜¯è¿™ä¸€æ¬¡ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªé”®åçš„é—®é¢˜--åœ¨ç»“æ„ä¸Šå­˜åœ¨ç€æ ¹æœ¬çš„å·®å¼‚ã€‚

å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„ Swift æ¨¡å‹çš„ç»“æ„ï¼Œä½¿ä¹‹ä¸æˆ‘ä»¬çš„ JSON æ•°æ®çš„ç»“æ„å®Œå…¨åŒ¹é…â€”â€”ä½†è¿™å¹¶ä¸æ€»æ˜¯å®ç”¨ã€‚è™½ç„¶æ‹¥æœ‰æ­£ç¡®çš„åºåˆ—åŒ–ä»£ç å¾ˆé‡è¦ï¼Œä½†æ‹¥æœ‰ä¸€ä¸ªé€‚åˆæˆ‘ä»¬å®é™…ä»£ç åº“çš„æ¨¡å‹ç»“æ„å¯ä»¥è¯´åŒæ ·é‡è¦ã€‚

ç›¸åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ã€ä¸“é—¨çš„ç±»å‹â€”â€”å®ƒå°†ä½œä¸ºæˆ‘ä»¬çš„ JSON æ•°æ®ä¸­ä½¿ç”¨çš„æ ¼å¼å’Œæˆ‘ä»¬çš„ Swift ä»£ç ç»“æ„ä¹‹é—´çš„ä¸€ä¸ªæ¡¥æ¢ã€‚åœ¨è¿™ä¸ªç±»å‹ä¸­ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿå°è£…æ‰€æœ‰å°† JSON æ±‡ç‡å­—å…¸è½¬åŒ–ä¸º `ExchangeRate` æ¨¡å‹æ•°ç»„æ‰€éœ€çš„é€»è¾‘â€”â€”æ¯”å¦‚è¿™æ ·ï¼š

```swift
private extension ExchangeRate {
    struct List: Decodable {
        let values: [ExchangeRate]
        
        // è¦†å†™ init(from decoder) æ–¹æ³•ï¼Œå°†å€¼ä¿å­˜åœ¨ values å±æ€§ä¸­
        init(from decoder: Decoder) throws {
            let container = try decoder.singleValueContainer()
            let dictionary = try container.decode([String : Double].self)
            
            // JSON Dictionary -> ExchangeRate
            values = dictionary.map { key, value in
                ExchangeRate(currency: currency(key), rate: value)
            }
        }
    }
}
```

ä½¿ç”¨ä¸Šè¿°ç±»å‹ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å®šä¹‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œå…¶åç§°ä¸ç”¨äºå…¶æ•°æ®çš„ JSON key ç›¸åŒ¹é…--å¹¶ä¸”è®©æˆ‘ä»¬çš„ `exchangeRates` å±æ€§ç®€å•åœ°ä½œä¸ºè¯¥ç§æœ‰å±æ€§çš„é¢å‘å…¬ä¼—çš„ä»£ç†ï¼š

```swift
struct CurrencyConversion: Decodable {
    var currency: Currency
    var exchangeRates: [ExchangeRate] {
        return rates.values
    }
    
    private var rates: ExchangeRate.List
}
```

> ä¸Šè¿°ä»£ç å¥æ•ˆçš„åŸå› æ˜¯ï¼Œåœ¨å¯¹ä¸€ä¸ªå€¼è¿›è¡Œç¼–ç æˆ–è§£ç æ—¶ï¼Œè®¡ç®—å±æ€§æ°¸è¿œä¸ä¼šè¢«è€ƒè™‘åœ¨å†…ã€‚

å½“æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬çš„ Swift ä»£ç ä¸ä½¿ç”¨ä¸åŒç»“æ„çš„ JSON API å…¼å®¹æ—¶ï¼Œä¸Šè¿°æŠ€æœ¯å¯ä»¥æˆä¸ºä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·â€”â€”åŒæ ·ä¸éœ€è¦å®Œå…¨ä»å¤´å®ç° `Codable` åè®®ã€‚



## è½¬æ¢å€¼

å½“æ¶‰åŠåˆ°è§£ç æ—¶ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸æˆ‘ä»¬æ— æ³•æ§åˆ¶çš„å¤–éƒ¨ JSON API åˆä½œæ—¶ï¼Œä¸€ä¸ªéå¸¸å¸¸è§çš„é—®é¢˜æ˜¯ï¼Œç±»å‹çš„ç¼–ç æ–¹å¼ä¸ Swift çš„ä¸¥æ ¼ç±»å‹ç³»ç»Ÿä¸å…¼å®¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦è§£ç çš„ JSON æ•°æ®å¯èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºæ•´æ•°æˆ–å…¶ä»–ç±»å‹çš„æ•°å­—ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬å¤„ç†è¿™æ ·çš„å€¼ï¼ŒåŒæ ·æ˜¯ä»¥ä¸€ç§è‡ªè¶³çš„æ–¹å¼ï¼Œä¸éœ€è¦æˆ‘ä»¬å†™ä¸€ä¸ªå®Œå…¨è‡ªå®šä¹‰çš„ Codable å®ç°ã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œæ‰€è¦åšçš„åŸºæœ¬ä¸Šæ˜¯å°†å­—ç¬¦ä¸²å€¼è½¬æ¢æˆå¦ä¸€ç§ç±»å‹â€”â€”è®©æˆ‘ä»¬ä»¥ `Int` ä¸ºä¾‹ã€‚æˆ‘ä»¬é¦–å…ˆè¦å®šä¹‰ä¸€ä¸ªåè®®ï¼Œè®©æˆ‘ä»¬æŠŠä»»ä½•ç±»å‹æ ‡è®°ä¸º `StringRepresentable`â€”â€”æ„å‘³ç€å®ƒæ—¢å¯ä»¥æ¥è‡ªå­—ç¬¦ä¸²æ ¼å¼ï¼Œä¹Ÿå¯ä»¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ï¼š

```swift
protocol StringRepresentable: CustomStringConvertible {
    init?(_ string: String)
}

extension Int: StringRepresentable {}
```

> æˆ‘ä»¬å°†ä¸Šè¿°åè®®å»ºç«‹åœ¨æ ‡å‡†åº“ä¸­çš„ `CustomStringConvertible` ä¹‹ä¸Šï¼Œå› ä¸ºå®ƒå·²ç»åŒ…å«äº†å°†ä¸€ä¸ªå€¼æè¿°ä¸ºå­—ç¬¦ä¸²çš„å±æ€§è¦æ±‚ã€‚æ›´å¤šå…³äºè¿™ç§å°†åè®®å®šä¹‰ä¸ºå…¶ä»–åè®®çš„ç‰¹æ®ŠåŒ–çš„æ–¹å¼ï¼Œè¯·æŸ¥çœ‹ "[Swift ä¸­çš„ç‰¹æ®ŠåŒ–åè®®](https://www.swiftbysundell.com/articles/specializing-protocols-in-swift/)"ã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªä¸“ç”¨ç±»å‹â€”â€”è¿™æ¬¡æ˜¯ä¸ºä»»ä½•å¯ä»¥ç”±å­—ç¬¦ä¸²æ”¯æŒçš„å€¼â€”â€”å¹¶è®©å®ƒåŒ…å«æ‰€æœ‰è§£ç å’Œç¼–ç ä¸€ä¸ªå­—ç¬¦ä¸²çš„å€¼æ‰€éœ€çš„ä»£ç ï¼š

```swift
struct StringBacked<Value: StringRepresentable>: Codable {
    var value: Value
    
    init(from decoder: Decoder) throws {
        let container = try decoder.singleValueContainer()
        let string = try container.decode(String.self)
        
        guard let value = Value(string) else {
            throw DecodingError.dataCorruptedError(
                in: container,
                debugDescription: """
                Failed to convert an instance of \(Value.self) from "\(string)"
                """
            )
        }
        
        self.value = value
    }
    
    func encode(to encoder: Encoder) throws {
        var container = encoder.singleValueContainer()
        try container.encode(value.description)
    }
}
```

å°±åƒæˆ‘ä»¬ä¹‹å‰ä¸º JSON å…¼å®¹çš„åº•å±‚å­˜å‚¨åˆ›å»ºäº†ä¸€ä¸ªç§æœ‰å±æ€§ä¸€æ ·ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸ºä»»ä½•ç¼–ç åç”±å­—ç¬¦ä¸²æ„æˆçš„å±æ€§åšåŒæ ·çš„äº‹æƒ…â€”â€”åŒæ—¶ä»ç„¶å°†è¯¥æ•°æ®ä½œä¸ºå…¶é€‚å½“çš„ç±»å‹æš´éœ²ç»™ Swift ä»£ç çš„å…¶ä»–éƒ¨åˆ†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹ `Video` ç±»å‹çš„ `numberOfLikes` å±æ€§è¿›è¡Œå¤„ç†çš„ä¾‹å­ï¼š

```swift
struct Video: Codable {
    var title: String
    var description: String
    var url: URL
    var thumbnailImageURL: URL
    
    var numberOfLikes: Int {
        get { return likes.value }
        set { likes.value = newValue }
    }
    
    private var likes: StringBacked<Int>
}
```

åœ¨ä¸å¾—ä¸ä¸ºä¸€ä¸ªå±æ€§æ‰‹åŠ¨å®šä¹‰ `Setter` å’Œ `Getter` çš„å¤æ‚æ€§å’Œä¸å¾—ä¸é€€å›åˆ°ä¸€ä¸ªå®Œå…¨è‡ªå®šä¹‰çš„ `Codable` å®ç°çš„å¤æ‚æ€§ä¹‹é—´ï¼Œè‚¯å®šä¼šæœ‰ä¸€ä¸ªæƒè¡¡â€”â€”ä½†å¯¹äºåƒä¸Šé¢çš„ `Video` ç»“æ„è¿™æ ·çš„ç±»å‹ï¼Œå®ƒåªæœ‰ä¸€ä¸ªéœ€è¦å®šåˆ¶çš„å±æ€§ï¼Œä½¿ç”¨ä¸€ä¸ªç§æœ‰å±æ€§å¯ä»¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚



## æ€»ç»“

ç¼–è¯‘å™¨èƒ½å¤Ÿè‡ªåŠ¨åˆæˆï¼ˆæ‰€æœ‰ä¸éœ€è¦ä»»ä½•å½¢å¼çš„å®šåˆ¶çš„ï¼‰éµå®ˆ `Codable` åè®®çš„ä»£ç ï¼Œè¿™ç¡®å®å¾ˆå¥‡å¦™--æˆ‘ä»¬èƒ½å¤Ÿåœ¨éœ€è¦çš„æ—¶å€™å®šåˆ¶ä¸œè¥¿ï¼Œè¿™ä¹ŸåŒæ ·å¥‡å¦™ã€‚

æ›´æ£’çš„æ˜¯ï¼Œè¿™æ ·åšå¾€å¾€ä¸éœ€è¦æˆ‘ä»¬å®Œå…¨æ”¾å¼ƒè‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œè€Œé‡‡ç”¨æ‰‹åŠ¨å®ç°çš„æ–¹å¼--å¾ˆå¤šæ—¶å€™ï¼Œåªéœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸ªç±»å‹çš„ç¼–ç æˆ–è§£ç æ–¹å¼ï¼Œè€Œä»ç„¶è®©ç¼–è¯‘å™¨å®Œæˆå¤§éƒ¨åˆ†çš„å·¥ä½œã€‚

ä½ æ€ä¹ˆçœ‹ï¼Ÿä½ æœ‰ä»€ä¹ˆå–œæ¬¢çš„æ–¹æ³•æ¥å®šåˆ¶ `Codable` åœ¨ Swift ä¸­çš„å·¥ä½œæ–¹å¼å—ï¼Ÿåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ `Codable` æ—¶ï¼Œä¸Šé¢çš„ä¸€äº›æŠ€æœ¯ä¼šæœ‰ç”¨å—ï¼Ÿè®©æˆ‘çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡ç”µå­é‚®ä»¶æˆ– Twitterã€‚

è°¢è°¢ä½ çš„é˜…è¯»ï¼ğŸš€
