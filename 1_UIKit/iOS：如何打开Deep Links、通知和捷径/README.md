> Reference：
> 
> * [iOS: How to open Deep Links, Notifications and Shortcuts](https://stasost.medium.com/ios-how-to-open-deep-links-notifications-and-shortcuts-253fb38e1696)
> * [Handling deeplinks in your app @2019-12-11](https://www.donnywals.com/handling-deeplinks-in-your-app/)


你有没有开发过一款处理推送通知的应用程序？如果您的应用程序比“Hello，World！”更复杂。那么，最有可能的是，答案是肯定的。

打开捷径（Shortcuts）怎么样？当所有新的 iOS 设备都支持3D触控时，这一功能将不仅仅是一个可有可无的附加功能。

您的应用程序支持通用链接吗？这是一个相对较新的功能，在现代应用程序中变得流行起来。因此，如果你还没有使用它，您可能想要开始。

好消息是，您可以很容易地找到几十个关于这三个主题的学习材料、示例和教程。但是，您的应用程序必须支持所有这些功能吗？您真的需要将其实现为三个独立的组件吗？

在继续之前，让我们先澄清一下术语：

1. **Universal Links（通用链接）** 是截取某些URL的方式，而不是在 Safari 中处理URL，而是打开特定的应用程序页面。通用链接需要一些后端工作，因此在本教程中我们将坚持使用 **Deep Links（深度链接）**。深度链接的作用类似，但它处理自定义URL方案。它的实现并没有太大的不同，所以如果您需要的话，添加一个通用链接支持并不困难。
2. **Shortcuts** 是当你用力按住应用程序图标时，基于选定的快捷方式项在特定页面上启动的方式。此功能需要支持3D触摸的设备。
3. **Notifications（通知）**：当您轻触通知（远程或本地）时，应用程序将在特定页面启动或执行特定操作。

从这个描述中你可以看到，所有这三个功能都是同一本质的不同类型：当应用程序处理它们中的任何一个时，它都是从特定的页面启动的。

> Apple 称之为启动选项，由 `AppDelegate didFinishLaunchingWithOptions` 方法处理。

然而，当涉及到所有启动选项的实现时，它会变得令人困惑，并且通常会导致数百行冗余代码。当应用程序不是启动，而是进入前台模式时，实现变得更加复杂。快捷方式处理、深度链接和通知处理发生在不同的委托方法中，似乎没有任何共同之处。

**为了清楚起见，我将再次声明：所有这些功能都服务于相同的目的-打开特定的应用程序页面。**

问题是，如何让这一切都以一种良好而干净的方式协同工作。



## 项目初始化


在我们开始实施任何启动选项之前，请创建您想要访问的页面列表。假设我们正在构建公寓预订应用程序，并且我们希望快速访问以下部分：

* 我的消息页面(预览)：通过 shortcut 访问
* 消息(特定聊天)：通过推送通知访问
* 创建新列表：仅限通过主机配置文件的 shortcut 访问
* 我的活动：通过 shortcut 访问
* 预订请求访问：通过电子邮件链接(深度链接)和推送通知访问

首先，创建一个简单的项目，其中包含ViewController、导航标题和切换配置文件按钮：

![](https://miro.medium.com/max/700/1*VnU1y_ydvTjD8a_fguVwrQ.png)


...